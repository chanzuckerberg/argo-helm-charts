suite: test grafana alert rule group
templates:
  - templates/alert_groups.yaml
tests:
  - it: renders GrafanaAlertRuleGroup when enabled
    asserts:
      - hasDocuments:
          count: 1
      - isKind:
          of: GrafanaAlertRuleGroup
      - equal:
          path: metadata.name
          value: loki-alerts
      - equal:
          path: spec.folderRef
          value: loki
      - equal:
          path: spec.instanceSelector.matchLabels.app
          value: grafana
      - equal:
          path: spec.name
          value: Loki Alerts
  - it: does not render when either toggle is disabled
    set:
      enabled: true
      alertRuleGroup:
        enabled: false
    asserts:
      - hasDocuments:
          count: 0
